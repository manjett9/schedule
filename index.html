<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –≥—Ä–∞—Ñ–∏–∫–∞ —Ä–∞–±–æ—Ç—ã</title>
    <script src="https://unpkg.com/xlsx/dist/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <style>
        :root {
            --primary-color: #4a6fa5;
            --secondary-color: #166088;
            --accent-color: #4CAF50;
            --danger-color: #f44336;
            --warning-color: #ff9800;
            --light-color: #f8f9fa;
            --dark-color: #343a40;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #f5f7fa;
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        h1 {
            color: var(--secondary-color);
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--primary-color);
        }
        
        h2, h3 {
            color: var(--secondary-color);
            margin-top: 20px;
        }
        
        .container {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
        }
        
        .panel {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            padding: 25px;
            flex: 1;
            min-width: 400px;
        }
        
        .controls {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .control-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }
        
        label {
            font-weight: 500;
            color: var(--secondary-color);
        }
        
        select, input[type="month"] {
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            min-width: 150px;
        }
        
        .period-selector {
            display: flex;
            gap: 15px;
            align-items: center;
        }
        
        textarea {
            width: 100%;
            height: 300px;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            resize: vertical;
            font-family: inherit;
            margin-top: 10px;
        }
        
        .buttons {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            flex-wrap: wrap;
        }
        
        button {
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }
        
        .btn-primary {
            background-color: var(--accent-color);
            color: white;
        }
        
        .btn-primary:hover {
            background-color: #3d8b40;
        }
        
        .btn-secondary {
            background-color: var(--primary-color);
            color: white;
        }
        
        .btn-secondary:hover {
            background-color: #3a5a8c;
        }
        
        .btn-danger {
            background-color: var(--danger-color);
            color: white;
        }
        
        .btn-danger:hover {
            background-color: #d32f2f;
        }
        
        .btn-warning {
            background-color: var(--warning-color);
            color: white;
        }
        
        .btn-warning:hover {
            background-color: #e68a00;
        }
        
        .employee-inputs {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .employee-row {
            display: flex;
            gap: 10px;
            align-items: center;
            flex-wrap: wrap;
            padding: 15px;
            background-color: var(--light-color);
            border-radius: 6px;
            transition: all 0.2s;
        }
        
        .employee-row:hover {
            background-color: #e9ecef;
        }
        
        .employee-row input[type="text"] {
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            flex: 1;
            min-width: 150px;
        }
        
        .add-employee {
            margin-top: 10px;
            width: 100%;
        }
        
        .example {
            background-color: #f0f7ff;
            padding: 10px;
            border-radius: 4px;
            margin-top: 5px;
            font-size: 0.9em;
        }
        
        .stats {
            margin-top: 20px;
            padding: 15px;
            background-color: #f8f9fa;
            border-radius: 6px;
            border-left: 4px solid var(--primary-color);
        }
        
        .stats h4 {
            margin-top: 0;
            color: var(--secondary-color);
        }
        
        .stats-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }
        
        .stats-table th, .stats-table td {
            padding: 8px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        
        .stats-table th {
            background-color: var(--light-color);
        }
        
        @media (max-width: 768px) {
            .container {
                flex-direction: column;
            }
            
            .panel {
                min-width: auto;
            }
            
            .employee-row {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .employee-row input {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <h1>–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –≥—Ä–∞—Ñ–∏–∫–∞ —Ä–∞–±–æ—Ç—ã</h1>
    
    <div class="container">
        <div class="panel">
            <h2>–í–≤–æ–¥ –¥–∞–Ω–Ω—ã—Ö</h2>
            
            <div class="controls">
                <div class="control-group">
                    <label>–ú–µ—Å—è—Ü:</label>
                    <input type="month" id="monthInput">
                </div>
                
                <div class="control-group">
                    <label>–ü–µ—Ä–∏–æ–¥:</label>
                    <div class="period-selector">
                        <label>
                            <input type="radio" name="period" value="1-15" checked> 1-15
                        </label>
                        <label>
                            <input type="radio" name="period" value="16-31"> 16-31
                        </label>
                        <label>
                            <input type="radio" name="period" value="full"> –í–µ—Å—å –º–µ—Å—è—Ü
                        </label>
                    </div>
                </div>
            </div>
            
            <div class="form-group">
                <label for="daysFormat">–§–æ—Ä–º–∞—Ç –≤–≤–æ–¥–∞ –¥–Ω–µ–π —Å –≤—Ä–µ–º–µ–Ω–µ–º:</label>
                <div class="example">–ü—Ä–∏–º–µ—Ä: 1(12.00),2,3(09.30),4,5(15.45),6</div>
            </div>
            
            <div class="employee-inputs" id="employeeInputs">
                <!-- –°—é–¥–∞ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è —Å—Ç—Ä–æ–∫–∏ —Å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º–∏ -->
            </div>
            
            <button class="add-employee btn-primary" onclick="addEmployee()">+ –î–æ–±–∞–≤–∏—Ç—å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞</button>
            
            <div class="buttons">
                <button class="btn-primary" onclick="generateSchedule()">–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ</button>
            </div>
        </div>
        
        <div class="panel">
            <h2>–†–µ–∑—É–ª—å—Ç–∞—Ç</h2>
            
            <textarea id="outputText" readonly></textarea>
            
            <div class="buttons">
                <button class="btn-secondary" onclick="copyToClipboard()">üìã –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
                <button class="btn-secondary" onclick="clearOutput()">üßπ –û—á–∏—Å—Ç–∏—Ç—å</button>
                <button class="btn-secondary" onclick="exportToWord()">üìù –í—ã–≥—Ä—É–∑–∏—Ç—å –≤ Word</button>
                <button class="btn-secondary" onclick="exportToExcel()">üíæ –í—ã–≥—Ä—É–∑–∏—Ç—å –≤ Excel</button>
            </div>
            
            <div id="statistics" class="stats">
                <h4>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:</h4>
                <div id="statsContent">–°–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏</div>
            </div>
        </div>
    </div>

    <script>
        // –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ
        document.addEventListener('DOMContentLoaded', function() {
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–µ–∫—É—â–∏–π –º–µ—Å—è—Ü –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
            const now = new Date();
            const month = (now.getMonth() + 1).toString().padStart(2, '0');
            document.getElementById('monthInput').value = `${now.getFullYear()}-${month}`;
            
            loadSavedData();
            
            // –ï—Å–ª–∏ –Ω–µ—Ç —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, –¥–æ–±–∞–≤–ª—è–µ–º –æ–¥–Ω—É –ø—É—Å—Ç—É—é —Å—Ç—Ä–æ–∫—É
            if (document.querySelectorAll('.employee-row').length === 0) {
                addEmployee();
            }
        });
        
        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ localStorage
        function saveData() {
            const employees = [];
            document.querySelectorAll('.employee-row').forEach(row => {
                employees.push({
                    name: row.querySelector('.employee-name').value,
                    days: row.querySelector('.employee-days').value
                });
            });
            
            localStorage.setItem('workScheduleData', JSON.stringify({
                employees: employees,
                period: document.querySelector('input[name="period"]:checked').value,
                month: document.getElementById('monthInput').value,
                outputText: document.getElementById('outputText').value
            }));
        }
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ localStorage
        function loadSavedData() {
            const savedData = localStorage.getItem('workScheduleData');
            if (savedData) {
                const data = JSON.parse(savedData);
                
                // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø–µ—Ä–∏–æ–¥
                if (data.period) {
                    document.querySelector(`input[name="period"][value="${data.period}"]`).checked = true;
                }
                
                // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –º–µ—Å—è—Ü
                if (data.month) {
                    document.getElementById('monthInput').value = data.month;
                }
                
                // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤
                if (data.employees && data.employees.length > 0) {
                    data.employees.forEach(employee => {
                        addEmployee(employee.name, employee.days);
                    });
                }
                
                // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≤—ã–≤–æ–¥
                if (data.outputText) {
                    document.getElementById('outputText').value = data.outputText;
                    updateStatistics();
                }
            }
        }
        
        // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞
        function addEmployee(name = '', days = '') {
            const employeeInputs = document.getElementById('employeeInputs');
            const newRow = document.createElement('div');
            newRow.className = 'employee-row';
            newRow.innerHTML = `
                <input type="text" placeholder="–§–∞–º–∏–ª–∏—è" class="employee-name" value="${name}">
                <input type="text" placeholder="–î–Ω–∏ —Ä–∞–±–æ—Ç—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä: 1(12.00),2,3(09.30))" class="employee-days" value="${days}">
                <button class="btn-danger remove-btn" onclick="removeEmployee(this)">üóëÔ∏è –£–¥–∞–ª–∏—Ç—å</button>
            `;
            employeeInputs.appendChild(newRow);
            
            // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
            newRow.querySelectorAll('input').forEach(input => {
                input.addEventListener('change', saveData);
            });
            
            saveData();
        }
        
        // –£–¥–∞–ª–µ–Ω–∏–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞
        function removeEmployee(button) {
            const row = button.parentNode;
            row.parentNode.removeChild(row);
            saveData();
        }
        
        // –û—á–∏—Å—Ç–∫–∞ –ø–æ–ª—è –≤—ã–≤–æ–¥–∞
        function clearOutput() {
            document.getElementById('outputText').value = '';
            document.getElementById('statsContent').innerHTML = '–°–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏';
            saveData();
        }
        
        // –ü–∞—Ä—Å–∏–Ω–≥ –¥–Ω–µ–π —Å –≤—Ä–µ–º–µ–Ω–µ–º
        function parseDaysWithTime(daysInput) {
            const items = daysInput.split(',');
            const result = [];
            
            items.forEach(item => {
                item = item.trim();
                if (!item) return;
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ –≤—Ä–µ–º—è –≤ —Å–∫–æ–±–∫–∞—Ö
                const timeMatch = item.match(/^(\d+)\(([\d:.]+)\)$/);
                if (timeMatch) {
                    result.push({
                        day: parseInt(timeMatch[1]),
                        time: timeMatch[2].replace('.', ':') // –ó–∞–º–µ–Ω—è–µ–º —Ç–æ—á–∫–∏ –Ω–∞ –¥–≤–æ–µ—Ç–æ—á–∏—è
                    });
                } else {
                    // –ï—Å–ª–∏ –≤—Ä–µ–º—è –Ω–µ —É–∫–∞–∑–∞–Ω–æ
                    result.push({
                        day: parseInt(item),
                        time: null
                    });
                }
            });
            
            return result;
        }
        
        // –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –º–µ—Å—è—Ü–µ –∏ –≥–æ–¥–µ
        function getMonthYear() {
            const monthInput = document.getElementById('monthInput').value;
            if (!monthInput) {
                const now = new Date();
                return {
                    month: now.getMonth() + 1,
                    year: now.getFullYear()
                };
            }
            
            const parts = monthInput.split('-');
            return {
                year: parseInt(parts[0]),
                month: parseInt(parts[1])
            };
        }
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–Ω—è –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –≤—ã–±—Ä–∞–Ω–Ω–æ–º—É –ø–µ—Ä–∏–æ–¥—É
        function isDayInPeriod(day, period) {
            if (period === 'full') return true;
            
            const [start, end] = period.split('-').map(Number);
            return day >= start && day <= end;
        }
        
        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è
        function generateSchedule() {
            const employeeRows = document.querySelectorAll('.employee-row');
            const period = document.querySelector('input[name="period"]:checked').value;
            const { month, year } = getMonthYear();
            
            // –°–æ–∑–¥–∞–µ–º –æ–±—ä–µ–∫—Ç –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –ø–æ –¥–Ω—è–º
            const schedule = {};
            const employeeStats = {};
            
            // –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –∫–∞–∂–¥–æ–≥–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞
            employeeRows.forEach(row => {
                const name = row.querySelector('.employee-name').value.trim();
                const daysInput = row.querySelector('.employee-days').value.trim();
                
                if (!name || !daysInput) return; // –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –ø—É—Å—Ç—ã–µ —Å—Ç—Ä–æ–∫–∏
                
                employeeStats[name] = { days: 0, daysWithTime: 0 };
                const daysWithTime = parseDaysWithTime(daysInput);
                
                daysWithTime.forEach(({day, time}) => {
                    if (isNaN(day)) return; // –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –Ω–µ—á–∏—Å–ª–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
                    
                    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–∏–æ–¥–∞
                    if (!isDayInPeriod(day, period)) {
                        return; // –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –¥–Ω–∏ –Ω–µ –∏–∑ –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –ø–µ—Ä–∏–æ–¥–∞
                    }
                    
                    if (!schedule[day]) {
                        schedule[day] = {
                            names: [],
                            times: {}
                        };
                    }
                    
                    // –î–æ–±–∞–≤–ª—è–µ–º —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞
                    schedule[day].names.push(name);
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
                    employeeStats[name].days++;
                    if (time) {
                        employeeStats[name].daysWithTime++;
                        schedule[day].times[name] = time;
                    }
                });
            });
            
            // –°–æ—Ä—Ç–∏—Ä—É–µ–º –¥–Ω–∏ –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é
            const sortedDays = Object.keys(schedule).sort((a, b) => a - b);
            
            // –§–æ—Ä–º–∏—Ä—É–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
            let result = '';
            
            sortedDays.forEach(day => {
                const date = new Date(year, month - 1, day);
                const dayOfWeek = date.toLocaleDateString('ru-RU', { weekday: 'short' });
                const formattedDay = day.toString().padStart(2, '0');
                const formattedMonth = month.toString().padStart(2, '0');
                
                let line = `${day}.${formattedMonth} ${dayOfWeek} `;
                
                // –§–æ—Ä–º–∏—Ä—É–µ–º —Å–ø–∏—Å–æ–∫ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ —Å –∏—Ö –≤—Ä–µ–º–µ–Ω–µ–º
                const employeesWithTime = schedule[day].names.map(name => {
                    return schedule[day].times[name] ? `${name}(${schedule[day].times[name]})` : name;
                }).join(', ');
                
                line += employeesWithTime;
                result += line + '\n';
            });
            
            document.getElementById('outputText').value = result;
            updateStatistics(employeeStats);
            saveData();
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
        function updateStatistics(stats = null) {
            const statsContent = document.getElementById('statsContent');
            
            if (!stats) {
                statsContent.innerHTML = '–°–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏';
                return;
            }
            
            let html = '<table class="stats-table"><tr><th>–°–æ—Ç—Ä—É–¥–Ω–∏–∫</th><th>–î–Ω–µ–π</th><th>–° —É–∫–∞–∑–∞–Ω–∏–µ–º –≤—Ä–µ–º–µ–Ω–∏</th></tr>';
            
            Object.keys(stats).forEach(name => {
                html += `<tr>
                    <td>${name}</td>
                    <td>${stats[name].days}</td>
                    <td>${stats[name].daysWithTime}</td>
                </tr>`;
            });
            
            html += '</table>';
            statsContent.innerHTML = html;
        }
        
        function copyToClipboard() {
            const outputText = document.getElementById('outputText');
            outputText.select();
            document.execCommand('copy');
            alert('–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞!');
        }
        
        // –≠–∫—Å–ø–æ—Ä—Ç –≤ Word (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç)
        function exportToWord() {
            const outputText = document.getElementById('outputText').value;
            if (!outputText) {
                alert('–°–Ω–∞—á–∞–ª–∞ —Å–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ');
                return;
            }
            
            const { month, year } = getMonthYear();
            const monthName = new Date(year, month - 1).toLocaleDateString('ru-RU', { month: 'long' });
            
            // –°–æ–∑–¥–∞–µ–º HTML-–¥–æ–∫—É–º–µ–Ω—Ç
            const htmlContent = `
                <!DOCTYPE html>
                <html>
                <head>
                    <meta charset="UTF-8">
                    <title>–ì—Ä–∞—Ñ–∏–∫ —Ä–∞–±–æ—Ç—ã –Ω–∞ ${monthName} ${year} –≥–æ–¥–∞</title>
                    <style>
                        body { font-family: Arial, sans-serif; line-height: 1.6; margin: 2cm; }
                        h1 { color: #166088; text-align: center; }
                        .schedule { margin-top: 20px; }
                        .day { margin-bottom: 10px; }
                    </style>
                </head>
                <body>
                    <h1>–ì—Ä–∞—Ñ–∏–∫ —Ä–∞–±–æ—Ç—ã –Ω–∞ ${monthName} ${year} –≥–æ–¥–∞</h1>
                    <div class="schedule">
                        ${outputText.split('\n').filter(line => line.trim()).map(line => 
                            `<div class="day">${line}</div>`
                        ).join('')}
                    </div>
                </body>
                </html>
            `;
            
            // –°–æ–∑–¥–∞–µ–º Blob —Å HTML-–∫–æ–Ω—Ç–µ–Ω—Ç–æ–º
            const blob = new Blob([htmlContent], { type: 'application/msword' });
            
            // –°–æ–∑–¥–∞–µ–º —Å—Å—ã–ª–∫—É –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `–≥—Ä–∞—Ñ–∏–∫_—Ä–∞–±–æ—Ç—ã_${month}_${year}.doc`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }
        
        // –≠–∫—Å–ø–æ—Ä—Ç –≤ Excel
        function exportToExcel() {
            const outputText = document.getElementById('outputText').value;
            if (!outputText) {
                alert('–°–Ω–∞—á–∞–ª–∞ —Å–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ');
                return;
            }
            
            const { month, year } = getMonthYear();
            const monthName = new Date(year, month - 1).toLocaleDateString('ru-RU', { month: 'long' });
            
            const lines = outputText.split('\n');
            const data = [];
            
            // –ó–∞–≥–æ–ª–æ–≤–æ–∫
            data.push(['–î–∞—Ç–∞', '–î–µ–Ω—å –Ω–µ–¥–µ–ª–∏', '–°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏']);
            
            lines.forEach(line => {
                if (!line.trim()) return;
                
                const parts = line.split(' ');
                const date = parts[0];
                const dayOfWeek = parts[1];
                const employees = parts.slice(2).join(' ');
                
                data.push([date, dayOfWeek, employees]);
            });
            
            const wb = XLSX.utils.book_new();
            const ws = XLSX.utils.aoa_to_sheet(data);
            XLSX.utils.book_append_sheet(wb, ws, "–ì—Ä–∞—Ñ–∏–∫ —Ä–∞–±–æ—Ç—ã");
            XLSX.writeFile(wb, `–≥—Ä–∞—Ñ–∏–∫_—Ä–∞–±–æ—Ç—ã_${month}_${year}.xlsx`);
        }
        
        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏
        document.getElementById('monthInput').addEventListener('change', saveData);
        document.querySelectorAll('input[name="period"]').forEach(radio => {
            radio.addEventListener('change', saveData);
        });
    </script>
</body>
</html>